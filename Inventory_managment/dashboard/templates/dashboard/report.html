{% load static %}

<!DOCTYPE html>
<html>
<head>
    <title>Sales Reports</title>
    <link rel="stylesheet" type="text/css" href="{% static 'dashboard/styles.css' %}">
</head>
<body>
    <nav>
        <ul>
            <li><a href="#">Home</a></li>
            <li class="dropdown">
                <a href="#" class="dropbtn">Content</a>
                <div class="dropdown-content">
                    <a href="#">Products</a>
                    <a href="#">Sales</a>
                    <a href="#">Reports</a>
                    <a href="#">Orders</a>
                </div>
            </li>
            <div class="right-content">
                <li>
                    <a href="#">Logout</a>
                </li>
                <li>
                    <a href="#">Profile</a>
                </li>
            </div>
        </ul>
    </nav>

    <h1>Sales Reports</h1>
    <form method="GET" action="{% url 'dashboard-reports' %}">
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" value="{% if selected_date %}{{ selected_date }}{% endif %}">
        <button type="submit">Apply</button>
    </form>

    <h2>Daily Sales</h2>
    <p>{{ daily_sales.0.sale_date }}</p>
    <table id="daily-sales">
        <tr>
            <th>No.</th>
            <th>Product Name</th>
            <th>Product Category</th>
            <th>Purchased Price</th>
            <th>Sale Price</th>
            <th>Profit</th>
            <th>Quantity</th>
            <th>Total Sale</th>
            <th>Total profit</th>
            <th>Date</th>
        </tr>
        {% for sale in daily_sales %}
        <tr>
            <td>{{ sale.no }}</td>
            <td>{{ sale.product_name }}</td>
            <td>{{ sale.product_category }}</td>
            <td>{{ sale.purchased_price }}</td>
            <td>{{ sale.sale_price }}</td>
            <td>{{ sale.profit }}</td>
            <td>{{ sale.quantity }}</td>
            <td>{{ sale.total_daily_sale_amount }}</td>
            <td>{{ sale.total_daily_profit }}</td>
            <td>{{ sale.sale_date }}</td>
        </tr>
        {% endfor %}
        <tr>
            <th colspan="7" style="text-align:right">Total Amount:</th>
            <td>{{ total_daily_sale_amount }}</td>
            <td>{{ total_daily_profit }}</td>
        </tr>
    </table>
    <button class="print-button" onclick="printTable('daily-sales', 'Daily Sales')">Print Daily Sales</button>

    <br>

    <h2>Weekly Sales</h2>
    <p>From {{ start_of_week }} - {{ end_of_week }}</p>
    <table id="weekly-sales">
        <tr>
            <th>No.</th>
            <th>Product Name</th>
            <th>Product Category</th>
            <th>Purchased Price</th>
            <th>Sale Price</th>
            <th>Profit</th>
            <th>Quantity</th>
            <th>Total Sale</th>
            <th>Total profit</th>
            <th>Date</th>
        </tr>
        {% for sale in weekly_sales %}
        <tr>
            <td>{{ sale.no }}</td>
            <td>{{ sale.product_name }}</td>
            <td>{{ sale.product_category }}</td>
            <td>{{ sale.purchased_price }}</td>
            <td>{{ sale.sale_price }}</td>
            <td>{{ sale.profit }}</td>
            <td>{{ sale.quantity }}</td>
            <td>{{ sale.total_weekly_sale_amount }}</td>
            <td>{{ sale.total_weekly_profit }}</td>
            <td>{{ sale.sale_date }}</td>
        </tr>
        {% endfor %}
        <tr>
            <th colspan="7" style="text-align:right">Total Amount:</th>
            <td>{{ total_weekly_sale_amount }}</td>
            <td>{{ total_weekly_profit }}</td>
        </tr>
    </table>
    <button class="print-button" onclick="printTable('weekly-sales', 'Weekly Sales')">Print Weekly Sales</button>

    <br>

    <h2>Monthly Sales</h2>
    <p>{{ monthly_sales.0.sale_date|date:"F" }}</p>
    <table id="monthly-sales">
        <tr>
            <th>No.</th>
            <th>Product Name</th>
            <th>Product Category</th>
            <th>Purchased Price</th>
            <th>Sale Price</th>
            <th>Profit</th>
            <th>Quantity</th>
            <th>Total Sale</th>
            <th>Total profit</th>
            <th>Date</th>
        </tr>
        {% for sale in monthly_sales %}
        <tr>
            <td>{{ sale.no }}</td>
            <td>{{ sale.product_name }}</td>
            <td>{{ sale.product_category }}</td>
            <td>{{ sale.purchased_price }}</td>
            <td>{{ sale.sale_price }}</td>
            <td>{{ sale.profit }}</td>
            <td>{{ sale.quantity }}</td>
            <td>{{ sale.total_monthly_sale_amount }}</td>
            <td>{{ sale.total_monthly_profit }}</td>
            <td>{{ sale.sale_date }}</td>
        </tr>
        {% endfor %}
        <tr>
            <th colspan="7" style="text-align:right">Total Amount:</th>
            <td>{{ total_monthly_sale_amount }}</td>
            <td>{{ total_monthly_profit }}</td>
        </tr>
    </table>
    <button class="print-button" onclick="printTable('monthly-sales', 'Monthly Sales')">Print Monthly Sales</button>

    <br>

    <h2>Yearly Sales</h2>
    <p>{{ yearly_sales.0.sale_date.year }}</p>
    <table id="yearly-sales">
        <tr>
            <th>No.</th>
            <th>Product Name</th>
            <th>Product Category</th>
            <th>Purchased Price</th>
            <th>Sale Price</th>
            <th>Profit</th>
            <th>Quantity</th>
            <th>Total Sale</th>
            <th>Total profit</th>
            <th>Date</th>
        </tr>
        {% for sale in yearly_sales %}
        <tr>
            <td>{{ sale.no }}</td>
            <td>{{ sale.product_name }}</td>
            <td>{{ sale.product_category }}</td>
            <td>{{ sale.purchased_price }}</td>
            <td>{{ sale.sale_price }}</td>
            <td>{{ sale.profit }}</td>
            <td>{{ sale.quantity }}</td>
            <td>{{ sale.total_yearly_sale_amount }}</td>
            <td>{{ sale.total_yearly_profit }}</td>
            <td>{{ sale.sale_date }}</td>
        </tr>
        {% endfor %}
        <tr>
            <th colspan="7" style="text-align:right">Total Amount:</th>
            <td>{{ total_yearly_sale_amount }}</td>
            <td>{{ total_yearly_profit }}</td>
        </tr>
    </table>
    <button class="print-button" onclick="printTable('yearly-sales', 'Yearly Sales')">Print Yearly Sales</button>

    <script>
        function printTable(tableId, title) {
            var printContents = "<h2>" + title + "</h2>" + document.getElementById(tableId).outerHTML;
            var originalContents = document.body.innerHTML;
            document.body.innerHTML = printContents;
            window.print();
            document.body.innerHTML = originalContents;
        }
    </script> 
</body>
</html>
